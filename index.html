<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#7c3aed">
  <link rel="manifest" id="manifest-placeholder">
  <title>Habit Tracker Pro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;
    
    function HabitTracker() {
      const [habits, setHabits] = useState([]);
      const [newHabit, setNewHabit] = useState('');
      const [showCelebration, setShowCelebration] = useState(false);

      useEffect(() => {
        const stored = localStorage.getItem('habits');
        if (stored) setHabits(JSON.parse(stored));
      }, []);

      const saveHabits = (h) => localStorage.setItem('habits', JSON.stringify(h));

      const addHabit = () => {
        if (!newHabit.trim()) return;
        const updated = [...habits, { id: Date.now(), name: newHabit, completedCount: 0, lastCompleted: null, streak: 0 }];
        setHabits(updated);
        saveHabits(updated);
        setNewHabit('');
      };

      const deleteHabit = (id) => {
        const updated = habits.filter(h => h.id !== id);
        setHabits(updated);
        saveHabits(updated);
      };

      const completeHabit = (id) => {
        new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTGH0fPTgjMGHm7A7+OZSA0PWqvn77BdGAg+ltryxHUpBSl+zPLaizsIGGS57OihUBELTKXh8bllHgU2jdXzzn8vBSF1xvDdlEILElyx6OyrWBUIQ5zd8sFuJAU').play();
        
        const updated = habits.map(h => {
          if (h.id !== id) return h;
          const today = new Date().toDateString();
          const isNew = !h.lastCompleted || new Date(h.lastCompleted).toDateString() !== today;
          return { ...h, completedCount: h.completedCount + 1, lastCompleted: Date.now(), streak: isNew ? h.streak + 1 : h.streak };
        });
        
        setHabits(updated);
        saveHabits(updated);
        setShowCelebration(true);
        setTimeout(() => setShowCelebration(false), 3000);
      };

      const isCompletedToday = (h) => h.lastCompleted && new Date(h.lastCompleted).toDateString() === new Date().toDateString();

      return (
        <div className="min-h-screen bg-gradient-to-br from-purple-900 via-purple-700 to-pink-600 p-4 md:p-8">
          {showCelebration && (
            <div className="fixed inset-0 flex items-center justify-center z-50 pointer-events-none">
              <div className="bg-white/90 backdrop-blur-sm rounded-3xl p-8 shadow-2xl animate-bounce">
                <img src="https://media.giphy.com/media/g9582DNuQppxC/giphy.gif" className="w-64 h-64 rounded-2xl" />
                <div className="text-4xl font-bold text-center mt-4 bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">Â¡Genial! ğŸ‰</div>
              </div>
            </div>
          )}
          
          <div className="max-w-4xl mx-auto">
            <div className="text-center mb-8">
              <h1 className="text-5xl font-bold text-white mb-2 drop-shadow-lg">Habit Tracker Pro</h1>
              <p className="text-purple-200 text-lg">Construye mejores hÃ¡bitos, un dÃ­a a la vez</p>
            </div>
            
            <div className="bg-white/10 backdrop-blur-md rounded-2xl p-6 mb-6 shadow-xl">
              <div className="flex gap-3">
                <input type="text" value={newHabit} onChange={(e) => setNewHabit(e.target.value)} onKeyPress={(e) => e.key === 'Enter' && addHabit()} placeholder="Nuevo hÃ¡bito (ej: Hacer ejercicio...)" className="flex-1 px-6 py-4 rounded-xl bg-white/20 text-white placeholder-purple-200 border-2 border-white/30 focus:border-white/60 focus:outline-none text-lg" />
                <button onClick={addHabit} className="px-8 py-4 bg-gradient-to-r from-pink-500 to-purple-500 text-white rounded-xl font-semibold hover:from-pink-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg">â• Agregar</button>
              </div>
            </div>
            
            <div className="space-y-4">
              {habits.length === 0 ? (
                <div className="bg-white/10 backdrop-blur-md rounded-2xl p-12 text-center shadow-xl">
                  <p className="text-purple-200 text-xl">No hay hÃ¡bitos aÃºn. Â¡Agrega tu primer hÃ¡bito! ğŸš€</p>
                </div>
              ) : habits.map(habit => {
                const done = isCompletedToday(habit);
                return (
                  <div key={habit.id} className={`bg-white/10 backdrop-blur-md rounded-2xl p-6 shadow-xl ${done ? 'bg-green-500/20 border-2 border-green-400/50' : ''}`}>
                    <div className="flex items-center justify-between">
                      <div className="flex-1">
                        <h3 className={`text-2xl font-semibold mb-2 ${done ? 'text-green-300 line-through' : 'text-white'}`}>{habit.name}</h3>
                        <div className="flex gap-6 text-purple-200">
                          <span>âœ“ {habit.completedCount} veces</span>
                          <span>ğŸ”¥ {habit.streak} dÃ­as seguidos</span>
                        </div>
                      </div>
                      <div className="flex gap-3">
                        <button onClick={() => completeHabit(habit.id)} disabled={done} className={`p-4 rounded-xl font-semibold transition-all shadow-lg ${done ? 'bg-green-500/50 text-green-200 cursor-not-allowed' : 'bg-gradient-to-r from-green-400 to-emerald-500 text-white hover:from-green-500 hover:to-emerald-600'}`}>âœ“</button>
                        <button onClick={() => deleteHabit(habit.id)} className="p-4 bg-red-500/20 hover:bg-red-500/40 text-red-300 rounded-xl">ğŸ—‘ï¸</button>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
            
            {habits.length > 0 && (
              <div className="mt-8 bg-white/10 backdrop-blur-md rounded-2xl p-6 shadow-xl">
                <h2 className="text-2xl font-bold text-white mb-4">EstadÃ­sticas</h2>
                <div className="grid grid-cols-3 gap-4">
                  <div className="text-center"><div className="text-4xl font-bold text-white">{habits.length}</div><div className="text-purple-200">HÃ¡bitos</div></div>
                  <div className="text-center"><div className="text-4xl font-bold text-white">{habits.reduce((s, h) => s + h.completedCount, 0)}</div><div className="text-purple-200">Total</div></div>
                  <div className="text-center"><div className="text-4xl font-bold text-white">{habits.filter(isCompletedToday).length}</div><div className="text-purple-200">Hoy</div></div>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    }
    
    ReactDOM.render(<HabitTracker />, document.getElementById('root'));
  </script>
  
  <script>
    const manifestJson = {name:"Habit Tracker Pro",short_name:"Habits",start_url:".",display:"standalone",background_color:"#7c3aed",theme_color:"#7c3aed",icons:[{src:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='%237c3aed' width='100' height='100'/%3E%3Ctext x='50' y='65' font-size='60' text-anchor='middle'%3EğŸš€%3C/text%3E%3C/svg%3E",sizes:"512x512",type:"image/svg+xml"}]};
    const blob = new Blob([JSON.stringify(manifestJson)], {type: 'application/json'});
    document.getElementById('manifest-placeholder').href = URL.createObjectURL(blob);
    
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register(URL.createObjectURL(new Blob([`self.addEventListener('install',e=>e.waitUntil(self.skipWaiting()));self.addEventListener('fetch',e=>e.respondWith(fetch(e.request)));`],{type:'application/javascript'})));
    }
  </script>
</body>
</html>